var Ethink=window.Ethink||(function(){var h={};var n={decimal:"",emptyTable:"",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)",infoPostFix:"",thousands:",",lengthMenu:"Show _MENU_ entries",loadingRecords:"Loading...",processing:"Processing...",search:"Search:",zeroRecords:"",paginate:{first:"首页",last:"末页",next:"下一页",previous:"上一页"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}};var o={paging:false,searching:false,ordering:false,info:false,scrollX:true,autoWidth:false,language:n};var d={paging:true,lengthChange:false,pageLength:5,pagingType:"full_numbers"};var c={ajax:"true",serverSide:true,fnServerData:function(r,q,v,w){var u=$(w.nTable).data("fn_serverData");if($.isFunction(u)){var t=u(w._iDisplayStart,w._iDisplayLength);if($(w.nTable).data("support_select")&&t.data){for(var s=0;s<t.data.length;s++){t.data[s]=["${radio}"].concat(t.data[s]);}}v({data:t.data,draw:q,recordsTotal:t.totalSize,recordsFiltered:t.totalSize});}else{console.info("fn_serverData is not function...");}}};h.processing=function(q){$("#system_info-processing").show();$("#system_info-processing .processing-tip").html("<span>"+(q||"")+"</span>");};h.processingCancel=function(){$("#system_info-processing").hide();};h.sys_processing=function(q){$("#system_info-sys_processing").show();$("#system_info-sys_processing .processing-tip").html("<span>"+(q||"")+"</span>");};h.sys_processingCancel=function(){$("#system_info-sys_processing").hide();};h.disableMenu=function(){$(".nav_shadow").show();};h.enableMenu=function(){$(".nav_shadow").hide();};h.showMenu=function(){$(".main-content").removeClass("full-width");$("nav.menu").show();};h.hideMenu=function(){$(".main-content").addClass("full-width");$("nav.menu").hide();};h.startTimerButton=function(r,t){var u=$(r).ladda();var s=u.find("span.ladda-label");var q=s.text();u.click(function(){u.ladda("start");window.setTimeout(function(){u.ladda("stop");},t*1000);var v=function(w){if(w>0){s.text(q+" ("+w+")");window.setTimeout(function(){v(w-1);},1000);}else{s.text(q);}};v(t);});};h.Table=function(r){var q="#"+r;var s=$(q);return f(s);};h.table=function(t,r){r=r||{};var q="#"+t;var s={};$.extend(s,o,r,{columnDefs:[{render:function(x,v,y,u){var w=$(q).data("table_column0_render");return $.isFunction(w)?w(x,v,y,u):x;},width:$(q).find("thead th:first").css("width"),targets:0}]});if(r.paging){$.extend(s,d);}if(r.paging&&r.serverData){$.extend(s,c);}$(q).DataTable(s);return f($(q));};function l(r){var q=[];q.push("<thead>");q.push('        <tr id="tr100">');q.push('            <th colspan="1" >面额</td>');q.push('            <th colspan="3" >数量</td>');q.push("            <th  >金额</td>");q.push("        </tr>");q.push("</thead>");q.push("<tbody></tbody>");q.push("<tfoot>");q.push("    <tr>");q.push('        <td class="cnysum" colspan="6">金额合计：<span id="tablesum" class="system-color"></span>元</td> ');q.push("    </tr>");q.push("</tfoot>");return q;}h.table_amt=function(s){var q=$("#"+s);$("#"+s).parent("div").addClass("amt_table_container");$("#"+s).html(l().join("\n"));var r={data:function(x){var u=[];for(var v=0;v<x.length;v++){var t=x[v];var w=t.unit||(t.type+"元");u.push("<tr>");u.push('<td width="130" ><span class="cnyicon cny'+t.type+'"></span></td>');u.push('<td width="100" class="cnytype">'+w+"</td>");u.push('<td width="30" >x</td>');u.push('<td width="60" class="cnycount"><span>'+t.count+"</span></td>");u.push('<td width="" class="cnyvalue">'+t.value+"</td>");u.push("</tr>");}q.find("tbody").html(u.join("\n"));return r;},sum:function(t){q.find("tfoot #tablesum").html(t);return r;}};return r;};h.table_edit_amt=function(s){var q=$("#"+s);$("#"+s).parent("div").addClass("amt_table_container");$("#"+s).html(l().join("\n"));var r={data:function(A){if(A){var u=[];var y={"1元":1,"5角":0.5,"1角":0.1};for(var x=0;x<A.length;x++){var t=A[x];var z=t.unit||(t.type+"元");var w=t.type;u.push('<tr data="'+w+'" index="'+x+'">');u.push('<td width="130" ><span class="cnyicon cny'+t.type+'"></span></td>');u.push('<td width="100" class="cnytype">'+z+"</td>");u.push('<td width="30" >x</td>');u.push('<td width="160" class="cnycount"><input type="text" id="'+s+"_"+t.type+'_input" class="table-control" maxlength="5" size="11"></td>');u.push('<td width="" class="cnyvalue"></td>');u.push("</tr>");}q.find("tbody").html(u.join("\n"));return r;}else{var v=[];q.find("tbody tr").each(function(C){var B=$(this);v.push({type:B.attr("data"),count:B.find("input.table-control").val(),value:B.find(".cnyvalue").text()});});return v;}},sum:function(t){if(t){q.find("tfoot #tablesum").html(t);}else{var x=r.data(),v=0;for(var u=0;u<x.length;u++){var w=parseFloat(x[u].value);w=isNaN(w)?0:w;v+=w;}r.sum(k(v));}return r;},click:function(t){if(t){q.find("input.table-control").data("_clickfun",t);}else{q.find("input:first").click();}return r;},change:function(t){q.find("input.table-control").data("_changefun",t);return r;},validate:function(t){q.find("input.table-control").data("_validatefun",t);return r;}};q.on("change","input.table-control",function(){var y=$(this).parents("tr");var w=parseFloat(y.attr("data"));var u=$(this).data("_validatefun");if($.isFunction(u)){var v=y.attr("index");var A=u.call(this,v);if(!A){return;}}var x=parseInt($(this).val());x=isNaN(x)?0:x;var z=q.hasClass("amt_coin")?w*x/100:w*x;y.find(".cnyvalue").text(k(z));r.sum();var t=$(this).data("_changefun");if($.isFunction(t)){t(w,this,y.find(".cnyvalue")[0]);}});q.on("click","input.table-control",function(){var t=$(this).data("_clickfun");if($.isFunction(t)){var u=$(this).parents("tr");t(u.attr("data"),this,u.find(".cnyvalue")[0]);}});return r;};h.select=function(s){var q="#"+s;var r=$(q).parent().find("select");if(r.length<1){return;console.info("未发现控件");}return{val:function(t){if(t){return r.val(t).trigger("comboselect:change");}else{return r.val();}},text:function(){return $(q).val();},change:function(t){r.change(function(w,u){t(w.target.value,w.target.selectedIndex);});}};};h.confirm=function(s,r,q){swal({title:s,text:r,type:"warning",showCancelButton:true,confirmButtonColor:"#bc0e17",confirmButtonText:"确定",cancelButtonText:"取消",closeOnConfirm:true},q);};h.error=function(s,r,q){swal({title:s,text:r,type:"error",confirmButtonColor:"#bc0e17",confirmButtonText:"确定",closeOnConfirm:true},q);};h.warning=function(s,r,q){swal({title:s,text:r,type:"warning",confirmButtonColor:"#bc0e17",confirmButtonText:"确定",closeOnConfirm:true},q);};h.success=function(s,r,q){swal({title:s,text:r,type:"success",confirmButtonColor:"#bc0e17",confirmButtonText:"确定",closeOnConfirm:true},q);};h.modal=function(r,q){$("#system_modal_container > div").hide();$("#system_modal_container #"+r).show();$("#system_modal_container").show();};h.modal_api=function(s){var r=$("#system_modal_container");var q=$("#system_modal_container > div");return{close:function(){r.hide();q.hide();}};};h.scrollTop=function(r){if(r==0||isNaN(r)){return;}var q=$("#mainContent").css("margin-top");q=q.substr(0,q.length-2);q=q-r;$("#mainContent").css({"margin-top":q+"px"});};h.support_mainscroll=function(){var q=[];q.push('<div id="system_scrollbar" style="position: absolute; right: 30px; top: 41%; font-size:54px; z-index:5000; ">');q.push('<div><a id="tmp_scroll_up" href="#"><i class="fa fa-chevron-circle-up"></i></a></div>');q.push('<div><a id="tmp_scroll_down" href="#"><i class="fa fa-chevron-circle-down"></i></a></div>');q.push("</div>");$("body").append(q.join("\n"));$("#system_scrollbar").on("click","#tmp_scroll_up",function(){h.scrollTop(-50);});$("#system_scrollbar").on("click","#tmp_scroll_down",function(){h.scrollTop(50);});};h.offsetBottom=function(t){var s=t;var u=s.offsetTop;var q=s.clientHeight;while(s.offsetParent!=null){u+=s.offsetParent.offsetTop;s=s.offsetParent;}var r=document.body.clientHeight-u-q-11;return r;};h.hide_btn=function(){return $("#system_hide_fn");};function k(u){var t=u+"";var q=t.indexOf(".");var s=t.length;if(q<0){return u+".00";}for(var r=0;r<=s-2-q;r++){t+="0";}return t;}function f(s,t){var q=s.DataTable();var r={table:q,data:function(v){if($.isFunction(v)){s.data("fn_serverData",v);}else{q.clear();for(var u=0;u<v.length;u++){q.row.add(s.data("support_select")?["${radio}"].concat(v[u]):v[u]);}q.draw();}return r;},selected:function(u){q.off("click","**");q.on("click","tr",function(v){e.apply(this,[q,u]);});return r;},support_select:function(){s.addClass("_system_support_tableselector");s.data("support_select",true);s.data("table_column0_render",function(x,w,y,u){var v=u.row;var z="radio"+v;return'<div class="radio radio-info radio-inline" value="'+v+'">    <label></label></div>';});return r;},reload:function(){q.ajax.reload();return r;}};return r;}function e(u,s){u.$("tr.selected").removeClass("selected");$(this).addClass("selected");u.$("input.selector").removeAttr("checked");u.$("tr.selected input.selector").attr("checked","checked");var r=$(this).parents("table");var q=$(this).find(".radio.radio-info").attr("value");var t=r.data("selectedIndex");r.data("selectedIndex",q);s({index:q,data:r.dataTable().api().data()[q]});}function i(q){try{$("select.ethink_select").comboSelect();$("select.ethink_select").parent().find("input").attr("disabled",true);$("select.ethink_select").parent().click(function(t){if($(t.target).hasClass("combo-input text-input")){var s=$(this).find("select.ethink_select");s.trigger("comboselect:open");}});}catch(r){console.info(r);}}function p(r){var q=$(".ladda-button.autoloading").ladda();q.click(function(){var s=$(this);s.ladda("start");setTimeout(function(){s.ladda("stop");},2000);});}function b(r){$(".menu li a").removeClass("selected");var q=$(".ctrl.showmenu").text();if(q){$(".menu li a#"+q).addClass("selected");}$(".nav_shadow").css({display:$(".ctrl.disable-menu").length>0?"block":"none"});}function a(r){var q;document.onmousedown=function(s){if($(s.target).parents(".support_dragscroll").length<1){return;}q=$(s.target).parents(".dataTables_scrollBody");if(q.length<1){return;}q[0].onselectstart=function(){return false;};q.data("startX",s.x);q.data("baseX",q.scrollLeft());};document.onmouseup=function(s){q=null;return false;};document.onmousemove=function(s){if(q){var t=q.data("startX")-s.x;t+=q.data("baseX");q.scrollLeft(t);}};}function m(q){$("#system_modal_container").html($(".ethink_modal").html());$(".ethink_modal").html("");}function j(q){$(".ethink_softkey").wrap('<div class="_system_temp"></div>');$("body").append($(".ethink_softkey"));$("._system_temp").empty();}function g(r){var q=document.body.clientWidth>1024?"flash_1280_1024":"flash_1024_768";$(".flashbox").each(function(){var t=$(this);var u=t.find("."+q);var w=systemConfig.flash||{};w.flash_1280_1024=w.flash_1280_1024||{width:840,height:520};w.flash_1024_768=w.flash_1024_768||{width:550,height:340};var s=w[q];s={width:u.attr("width")||s.width,height:u.attr("height")||s.height};var v=[];v.push('<object id="flashcontent" width="'+s.width+'" height="'+s.height+'" align="middle" ');v.push('    data="'+u.attr("path")+'" ');v.push('    type="application/x-shockwave-flash"> ');v.push('    <param name="wmode" value="transparent"> ');v.push('    <param name="allowscriptaccess" value="always"> ');v.push('    <param name="allowfullscreen"   value="true">');v.push("</object>");t.append(v.join("\n"));});}(function(){m();b();i();p();j();g();a();})();return h;})();window.Ethink=Ethink;